generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Settings {
  id             Int      @id @default(autoincrement())
  siteTitle      String   @default("YOKO AJANS")
  heroCardUserId Int?
  heroCardUser   User?    @relation("HeroCardUser", fields: [heroCardUserId], references: [id])
  taglineTR      String   @default("Birlikte ƒ∞zle, Birlikte Hisset.")
  taglineEN      String   @default("Watch Together, Feel Together.")
  logoUrl        String   @default("")
  primaryColor   String   @default("#d4af37")
  bgImageUrl     String   @default("")
  heroTitleTR    String   @default("YOKO AJANS")
  heroTitleEN    String   @default("YOKO AJANS")
  menuHomeTR     String   @default("Ana Sayfa")
  menuHomeEN     String   @default("Home")
  menuRoomsTR    String   @default("Sinema Odalarƒ±")
  menuRoomsEN    String   @default("Cinema Rooms")
  menuEventsTR   String   @default("Etkinlikler")
  menuEventsEN   String   @default("Events")
  menuTopTR      String   @default("Ayƒ±n Elemanlarƒ±")
  menuTopEN      String   @default("Top Members")
  menuAnnouncTR  String   @default("Duyurular")
  menuAnnouncEN  String   @default("Announcements")
  menuVipTR      String   @default("VIP")
  menuVipEN      String   @default("VIP")
  menuAdminTR    String   @default("Y√∂netim")
  menuAdminEN    String   @default("Management")
  menuSettingsTR String   @default("Ayarlar")
  menuSettingsEN String   @default("Settings")
  whatsappUrl    String   @default("")
  telegramUrl    String   @default("")
  supportUrl     String   @default("/")
  showWhatsapp   Boolean  @default(true)
  showTelegram   Boolean  @default(true)
  showSupport    Boolean  @default(true)
  wolfImageUrl        String   @default("")
  heroCardSubtitle    String   @default("Sesin G√ºc√º Bizde!")
  heroCardStat1Icon   String   @default("üîí")
  heroCardStat1Value  String   @default("145")
  heroCardStat1Label  String   @default("Aktif Yayƒ±ncƒ±")
  heroCardStat2Icon   String   @default("üèÜ")
  heroCardStat2Value  String   @default("98,750 ‚Ç∫")
  heroCardStat2Label  String   @default("Bu Ayki Kazan√ß")
  updatedAt           DateTime @updatedAt
}

model PwaSettings {
  id              Int      @id @default(autoincrement())
  name            String   @default("YOKO AJANS")
  shortName       String   @default("YOKO")
  descriptionTR   String   @default("Birlikte ƒ∞zle, Birlikte Hisset.")
  descriptionEN   String   @default("Watch Together, Feel Together.")
  themeColor      String   @default("#0f0f14")
  backgroundColor String   @default("#0f0f14")
  icon192Url      String   @default("/icons/icon-192.png")
  icon512Url      String   @default("/icons/icon-512.png")
  startUrl        String   @default("/")
  scope           String   @default("/")
  display         String   @default("standalone")
  version         Int      @default(1)
  enabled         Boolean  @default(true)
  updatedAt       DateTime @updatedAt
}

model User {
  id              Int              @id @default(autoincrement())
  username        String           @unique
  email           String           @unique
  passwordHash    String
  role            String           @default("user")
  vip             Boolean          @default(false)
  vipExpiresAt    DateTime?
  banned          Boolean          @default(false)
  bannedUntil     DateTime?
  avatarUrl       String           @default("")
  avatarType      String           @default("image")
  frameType       String           @default("")
  badges          String           @default("")
  xp              Int              @default(0)
  level           Int              @default(1)
  bio             String           @default("")
  createdAt       DateTime         @default(now())
  messages        Message[]
  globalMessages  GlobalMessage[]
  directSent      DirectMessage[]  @relation("DMSender")
  directReceived  DirectMessage[]  @relation("DMReceiver")
  friendsSent     FriendRequest[]  @relation("FriendRequester")
  friendsReceived FriendRequest[]  @relation("FriendReceiver")
  friendshipsA    Friendship[]     @relation("FriendshipUserA")
  friendshipsB    Friendship[]     @relation("FriendshipUserB")
  auditLogs       AuditLog[]
  ownedRooms      Room[]           @relation("RoomOwner")
  heroCardRef     Settings[]       @relation("HeroCardUser")
  roomModsGiven   RoomModerator[]  @relation("ModeratorAssigner")
  roomModsHeld    RoomModerator[]  @relation("ModeratorUser")
  roomBansGiven   RoomBan[]        @relation("BanBanner")
  roomBansHeld    RoomBan[]        @relation("BanUser")
}

model Room {
  id                    Int              @id @default(autoincrement())
  title                 String
  description           String           @default("")
  movieTitle            String           @default("")
  posterUrl             String           @default("")
  streamUrl             String           @default("")
  providerType          String           @default("youtube")
  isTrending            Boolean          @default(false)
  allowedRoles          String           @default("user,vip,admin")
  maxUsers              Int              @default(100)
  isActive              Boolean          @default(true)
  isLocked              Boolean          @default(false)
  passwordHash          String?
  chatEnabled           Boolean          @default(true)
  spamProtectionEnabled Boolean          @default(true)
  spamCooldownSeconds   Int              @default(3)
  ownerId               Int?
  createdAt             DateTime         @default(now())
  updatedAt             DateTime         @updatedAt
  deletedAt             DateTime?
  messages              Message[]
  state                 RoomState?
  moderators            RoomModerator[]
  bans                  RoomBan[]
  owner                 User?            @relation("RoomOwner", fields: [ownerId], references: [id])
}

model RoomModerator {
  id          Int      @id @default(autoincrement())
  roomId      Int
  userId      Int
  assignedBy  Int
  createdAt   DateTime @default(now())
  room        Room     @relation(fields: [roomId], references: [id], onDelete: Cascade)
  user        User     @relation("ModeratorUser", fields: [userId], references: [id])
  assigner    User     @relation("ModeratorAssigner", fields: [assignedBy], references: [id])
  @@unique([roomId, userId])
}

model RoomBan {
  id        Int      @id @default(autoincrement())
  roomId    Int
  userId    Int
  bannedBy  Int
  reason    String   @default("")
  createdAt DateTime @default(now())
  room      Room     @relation(fields: [roomId], references: [id], onDelete: Cascade)
  user      User     @relation("BanUser", fields: [userId], references: [id])
  banner    User     @relation("BanBanner", fields: [bannedBy], references: [id])
  @@unique([roomId, userId])
}

model RoomState {
  id                Int      @id @default(autoincrement())
  roomId            Int      @unique
  isPlaying         Boolean  @default(false)
  currentTimeSeconds Float   @default(0)
  streamUrlVersion  Int      @default(1)
  lastUpdatedAt     DateTime @default(now())
  room              Room     @relation(fields: [roomId], references: [id])
}

model Message {
  id          Int       @id @default(autoincrement())
  roomId      Int
  userId      Int
  content     String
  reaction    String    @default("")
  replyToId   Int?
  createdAt   DateTime  @default(now())
  deletedAt   DateTime?
  room        Room      @relation(fields: [roomId], references: [id])
  user        User      @relation(fields: [userId], references: [id])
  replyTo     Message?  @relation("MessageReplies", fields: [replyToId], references: [id])
  replies     Message[] @relation("MessageReplies")
}

model GlobalMessage {
  id        Int       @id @default(autoincrement())
  userId    Int
  content   String
  createdAt DateTime  @default(now())
  deletedAt DateTime?
  user      User      @relation(fields: [userId], references: [id])
}

model FriendRequest {
  id          Int      @id @default(autoincrement())
  fromId      Int
  toId        Int
  status      String   @default("pending")
  createdAt   DateTime @default(now())
  from        User     @relation("FriendRequester", fields: [fromId], references: [id])
  to          User     @relation("FriendReceiver", fields: [toId], references: [id])
  @@unique([fromId, toId])
}

model Friendship {
  id        Int      @id @default(autoincrement())
  userAId   Int
  userBId   Int
  createdAt DateTime @default(now())
  userA     User     @relation("FriendshipUserA", fields: [userAId], references: [id])
  userB     User     @relation("FriendshipUserB", fields: [userBId], references: [id])
  @@unique([userAId, userBId])
}

model DirectMessage {
  id         Int      @id @default(autoincrement())
  fromId     Int
  toId       Int
  content    String
  read       Boolean  @default(false)
  createdAt  DateTime @default(now())
  deletedAt  DateTime?
  from       User     @relation("DMSender", fields: [fromId], references: [id])
  to         User     @relation("DMReceiver", fields: [toId], references: [id])
}

model Announcement {
  id        Int      @id @default(autoincrement())
  titleTR   String
  titleEN   String
  contentTR String
  contentEN String
  pinned    Boolean  @default(false)
  createdAt DateTime @default(now())
}

model Event {
  id            Int      @id @default(autoincrement())
  titleTR       String
  titleEN       String
  descriptionTR String   @default("")
  descriptionEN String   @default("")
  startTime     DateTime
  posterUrl     String   @default("")
  badge         String   @default("")
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
}

model AuditLog {
  id        Int      @id @default(autoincrement())
  adminId   Int
  action    String
  target    String
  detail    String   @default("")
  createdAt DateTime @default(now())
  admin     User     @relation(fields: [adminId], references: [id])
}

model News {
  id          Int      @id @default(autoincrement())
  title       String
  description String   @default("")
  imageUrl    String   @default("")
  videoUrl    String   @default("")
  published   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
